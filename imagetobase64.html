<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Image → Base64 Converter</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    body{display:flex;align-items:center;justify-content:center;min-height:100vh;background:#f7f7fb;margin:0;padding:24px}
    .card{width:100%;max-width:880px;background:#fff;border-radius:12px;box-shadow:0 6px 20px rgba(20,20,50,0.08);padding:22px}
    h1{margin:0 0 10px;font-size:18px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    .a{text-decoration:underline;colour:blue;}
    .full{grid-column:1/-1}
    label.button{display:inline-block;padding:10px 14px;background:#111827;color:#fff;border-radius:8px;cursor:pointer}
    input[type=file]{display:none}
    .drop{border:2px dashed #e6e6ef;border-radius:8px;padding:18px;min-height:120px;display:flex;align-items:center;justify-content:center;text-align:center;color:#666}
    .preview{max-height:240px;display:flex;align-items:center;justify-content:center;border-radius:8px;background:#fbfbff;padding:10px;overflow:hidden}
    img.preview-img{max-width:100%;max-height:220px;border-radius:6px}
    textarea{width:100%;height:220px;resize:vertical;padding:12px;border-radius:8px;border:1px solid #e9e9f0;background:#fbfbff;font-family:monospace;outline:none}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    button{padding:10px 12px;border-radius:8px;border:0;cursor:pointer}
    button.secondary{background:#eef2ff}
    button.ghost{background:transparent;border:1px solid #ddd}
    .meta{font-size:13px;color:#666;margin-top:8px}
    .hint{font-size:13px;color:#7b7b90}
    @media (max-width:760px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <main class="card" role="main">
    <h1>Image → Base64 Converter</h1>
    <p class="hint">Drop an image, choose a file, or paste an image URL. Output appears as a data URL you can copy or download. Do you want a Base64 to Image converter? <a href="base64toimage.html">Click Here</a></p><section class="grid" aria-label="converter">
  <div class="full">
    <div class="drop" id="dropzone">
      <div>
        <strong>Drop image here</strong>
        <div style="margin-top:8px" class="hint">or <label for="file" class="button" style="display:inline-block">Choose file</label></div>
        <input id="file" type="file" accept="image/*">
        <div class="meta" style="margin-top:8px">You can also paste an image (Ctrl/Cmd+V) or enter an image URL below.</div>
      </div>
    </div>
  </div>

  <div>
    <div class="preview" id="previewArea">No image selected</div>
    <div class="meta" id="imgMeta"></div>
  </div>

  <div>
    <label for="urlInput">Image URL</label>
    <input id="urlInput" type="url" placeholder="https://example.com/image.png" style="width:100%;padding:10px;border-radius:8px;border:1px solid #e9e9f0;margin-top:6px">
    <div class="controls" style="margin-top:10px">
      <button id="fetchBtn" class="secondary">Fetch URL</button>
      <button id="clearBtn" class="ghost">Clear</button>
    </div>
  </div>

  <div class="full">
    <label for="output">Base64 (data URL)</label>
    <textarea id="output" readonly placeholder="Your base64 data URL will appear here"></textarea>
    <div style="display:flex;gap:8px;margin-top:8px;"> 
      <button id="copyBtn">Copy</button>
      <button id="downloadBtn" class="secondary">Download as file</button>
      <button id="openBtn" class="ghost">Open data URL</button>
    </div>
  </div>
</section>

<p class="meta full">Tip: Large images will produce large base64 strings. Use this for small images, icons, or quick debugging.</p>

  </main>  <script>
    const dropzone = document.getElementById('dropzone');
    const fileInput = document.getElementById('file');
    const previewArea = document.getElementById('previewArea');
    const output = document.getElementById('output');
    const copyBtn = document.getElementById('copyBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const openBtn = document.getElementById('openBtn');
    const fetchBtn = document.getElementById('fetchBtn');
    const urlInput = document.getElementById('urlInput');
    const clearBtn = document.getElementById('clearBtn');
    const imgMeta = document.getElementById('imgMeta');

    function reset() {
      previewArea.innerHTML = 'No image selected';
      output.value = '';
      imgMeta.textContent = '';
    }

    function showPreview(imgEl, name, size) {
      previewArea.innerHTML = '';
      imgEl.classList.add('preview-img');
      previewArea.appendChild(imgEl);
      imgMeta.textContent = `${name} — ${Math.round(size/1024)} KB`;
    }

    async function fileToDataURL(file) {
      return new Promise((res, rej) => {
        const reader = new FileReader();
        reader.onerror = () => rej(new Error('File read error'));
        reader.onload = () => res(reader.result);
        reader.readAsDataURL(file);
      });
    }

    async function handleFile(file) {
      if (!file || !file.type.startsWith('image/')) return alert('Please provide an image file.');
      try {
        const dataUrl = await fileToDataURL(file);
        output.value = dataUrl;
        const img = new Image();
        img.src = dataUrl;
        img.onload = () => showPreview(img, file.name || 'image', file.size);
      } catch (e) {
        alert('Could not read file: ' + e.message);
      }
    }

    fileInput.addEventListener('change', e => {
      const f = e.target.files && e.target.files[0];
      handleFile(f);
    });

    // Drag & drop
    ['dragenter','dragover'].forEach(ev => dropzone.addEventListener(ev, e => { e.preventDefault(); dropzone.style.borderColor = '#8b5cf6'; }));
    ['dragleave','drop'].forEach(ev => dropzone.addEventListener(ev, e => { e.preventDefault(); dropzone.style.borderColor = ''; }));
    dropzone.addEventListener('drop', e => {
      const f = e.dataTransfer.files && e.dataTransfer.files[0];
      handleFile(f);
    });

    // Paste image from clipboard
    window.addEventListener('paste', e => {
      const items = e.clipboardData && e.clipboardData.items;
      if (!items) return;
      for (const it of items) {
        if (it.type && it.type.startsWith('image/')) {
          const blob = it.getAsFile();
          handleFile(blob);
          return;
        }
      }
    });

    copyBtn.addEventListener('click', async () => {
      if (!output.value) return alert('Nothing to copy');
      try {
        await navigator.clipboard.writeText(output.value);
        copyBtn.textContent = 'Copied!';
        setTimeout(()=>copyBtn.textContent='Copy',1200);
      } catch (e) {
        alert('Copy failed: ' + e.message);
      }
    });

    downloadBtn.addEventListener('click', () => {
      if (!output.value) return alert('Nothing to download');
      // try to infer filename
      const mimeMatch = output.value.match(/^data:(image\/[a-z0-9.+-]+);base64,/i);
      const ext = mimeMatch ? mimeMatch[1].split('/')[1] : 'png';
      const filename = 'image.'+ext;
      const a = document.createElement('a');
      a.href = output.value;
      a.download = filename;
      a.click();
    });

    openBtn.addEventListener('click', () => {
      if (!output.value) return alert('Nothing to open');
      const w = window.open();
      w.document.write('<iframe src="'+output.value+'" frameborder=0 style="border:0;top:0;left:0;bottom:0;right:0;width:100%;height:100%;"></iframe>');
    });

    clearBtn.addEventListener('click', reset);

    fetchBtn.addEventListener('click', async () => {
      const url = urlInput.value.trim();
      if (!url) return alert('Enter an image URL');
      try {
        // fetch as blob so we can convert to base64 on the client
        const res = await fetch(url, {mode:'cors'});
        if (!res.ok) throw new Error('Network response was not ok');
        const blob = await res.blob();
        // if not an image, warn but still try
        if (!blob.type.startsWith('image/')) {
          if (!confirm('Fetched resource is not an image. Continue?')) return;
        }
        const file = new File([blob], url.split('/').pop()||'image', {type:blob.type});
        handleFile(file);
      } catch (e) {
        alert('Could not fetch image: ' + e.message + '\nHint: CORS may block some remote images. Try a different URL or download the image first.');
      }
    });

    // keyboard accessibility for dropzone
    dropzone.addEventListener('click', () => fileInput.click());

    // init
    reset();
  </script></body>
                                                      </html>
